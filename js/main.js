!function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var i=[{id:1,name:"Wooden colored airplane",image:"./images/products/1_airplane.jpg",price:"CHF 4.99"},{id:2,name:"Minion guitarists figures",image:"./images/products/2_minions_guitarists.jpg",price:"CHF 9.99"},{id:3,name:"Jungle animal figures",image:"./images/products/3_jungle_animals.jpg",price:"CHF 15.99"},{id:4,name:"Yoshi figure",image:"./images/products/4_yoshi.jpg",price:"CHF 9.99"},{id:5,name:"Red VW beetle metalic car",image:"./images/products/5_red_beetle_car.jpg",price:"CHF 20.99"},{id:6,name:"Spiderman plastic figure",image:"./images/products/6_spiderman.jpg",price:"CHF 14.99"},{id:7,name:"Purple strass horse",image:"./images/products/7_purple_strass_horse.jpg",price:"CHF 3.99"},{id:8,name:"Brown bear plush",image:"./images/products/8_brown_bear_plush.jpg",price:"CHF 11.99"}];var n=class{constructor(){try{const e=document.getElementById("modal-template"),t=document.importNode(e.content,!0);this.el=t.querySelector(".modal"),this.contentEl=this.el.querySelector(".modal-main-content"),document.body.appendChild(this.el),this.el.querySelector(".modal-close-button").addEventListener("click",this.hide.bind(this))}catch(e){console.error("Error in creating modal"),console.error(e)}}render(e){this.contentEl.innerHTML="",this.contentEl.appendChild(e)}show(){this.el.style.display="flex"}hide(){this.el.style.display="none"}};class o{init(){this.state={products:i,shoppingCart:[],user:{name:"",gender:"",address:""}},this.viewRenderFns={userDataForm:this.createUserDataForm.bind(this),shoppingCart:this.createShoppingCart.bind(this),checkoutView:this.createCheckoutView.bind(this)},this.modal=new n,this.setupEventListeners(),this.renderProducts(),this.setProductView("grid")}static getAncestorBySel(e,t){if(e.matches(t))return e;let r=e.parentNode;for(;r;){if("function"==typeof r.matches&&r.matches(t))return r;r=r.parentNode}return null}setupEventListeners(){document.addEventListener("click",e=>{if(o.getAncestorBySel(e.target,"#list-view-btn"))return this.setProductView("list");if(o.getAncestorBySel(e.target,"#grid-view-btn"))return this.setProductView("grid");if(o.getAncestorBySel(e.target,"#view-shopping-cart-btn"))return this.renderViewModal("shoppingCart");if(o.getAncestorBySel(e.target,"#view-user-data-btn"))return this.renderViewModal("userDataForm");if(o.getAncestorBySel(e.target,"#view-checkout-btn"))return this.renderViewModal("checkoutView");if(o.getAncestorBySel(e.target,"#send-order-btn"))return this.printOrder();let t;return(t=o.getAncestorBySel(e.target,".button-add-to-cart"))?this.addToCartHandler(t):(t=o.getAncestorBySel(e.target,".button-remove-from-cart"))?this.removeFromCartHandler(t):null}),document.addEventListener("submit",e=>{let t;(t=o.getAncestorBySel(e.target,"#user-data-form"))&&(e.preventDefault(),this.state={...this.state,user:{name:t.username.value.trim(),gender:t.gender.value.trim(),address:t.address.value.trim()}})})}addToCartHandler(e){try{const t=parseInt(e.dataset.itemId),r=this.productById(t);return this.addItemToCart(r),this.renderViewModal("shoppingCart")}catch(e){console.error("Error adding item to cart"),console.error(e)}}removeFromCartHandler(e){try{const t=parseInt(e.dataset.itemId),r=this.productById(t);return this.removeItemFromCart(r),this.renderViewModal("shoppingCart")}catch(e){console.error("Error removing item from cart"),console.error(e)}}productById(e){return this.state.products.find(t=>t.id===e)}setProductView(e){"grid"===e?(document.getElementById("list-view-btn").classList.remove("active"),document.getElementById("grid-view-btn").classList.add("active"),document.getElementById("product-list").classList.remove("list-view"),document.getElementById("product-list").classList.add("grid-view")):"list"===e&&(document.getElementById("grid-view-btn").classList.remove("active"),document.getElementById("list-view-btn").classList.add("active"),document.getElementById("product-list").classList.remove("grid-view"),document.getElementById("product-list").classList.add("list-view"))}renderProducts(){const e=document.getElementById("product-list"),t=document.getElementById("product-item-template");this.state.products.forEach(r=>{const i=document.importNode(t.content,!0),n=i.querySelector("div.product-item-image-placeholder img");n.src=r.image,n.alt=`${r.name} image`,i.querySelector("div.product-item-name").textContent=r.name,i.querySelector("div.product-item-price").textContent=r.price,i.querySelector("div.product-item-add-to-cart > button").setAttribute("data-item-id",r.id),e.appendChild(i)})}addItemToCart(e){this.state.shoppingCart.find(t=>t.id===e.id)||(this.state={...this.state,shoppingCart:[...this.state.shoppingCart,e]})}removeItemFromCart(e){this.state={...this.state,shoppingCart:this.state.shoppingCart.filter(t=>t.id!==e.id)}}createUserDataForm(){const e=document.getElementById("user-data-form-template");return document.importNode(e.content,!0)}createShoppingCart(){const e=document.getElementById("shopping-cart-template"),t=document.importNode(e.content,!0);if(0===this.state.shoppingCart.length){const e=document.getElementById("shopping-cart-empty-message"),r=document.importNode(e.content,!0);return t.appendChild(r),t}const r=document.getElementById("shopping-cart-items-template"),i=document.importNode(r.content,!0);t.appendChild(i);const n=t.getElementById("shopping-cart-list"),o=document.getElementById("product-row-shopping-cart-template");return this.state.shoppingCart.forEach(e=>{const t=document.importNode(o.content,!0),r=t.querySelector("div.product-item-image-placeholder img");r.src=e.image,r.alt=`${e.name} image`,t.querySelector("div.product-item-name").textContent=e.name,t.querySelector("div.product-item-price").textContent=e.price,t.querySelector("div.product-item-remove-from-cart > button").setAttribute("data-item-id",e.id),n.appendChild(t)}),t}createCheckoutView(){const e=document.getElementById("checkout-view-template"),t=document.importNode(e.content,!0);t.querySelector(".checkout-user-name").textContent=this.state.user.name,t.querySelector(".checkout-user-gender").textContent=this.state.user.gender,t.querySelector(".checkout-user-address").textContent=this.state.user.address;const r=t.getElementById("checkout-product-list"),i=document.getElementById("product-row-checkout-template");return this.state.shoppingCart.forEach(e=>{const t=document.importNode(i.content,!0),n=t.querySelector("div.product-item-image-placeholder img");n.src=e.image,n.alt=`${e.name} image`,t.querySelector("div.product-item-name").textContent=e.name,t.querySelector("div.product-item-price").textContent=e.price,r.appendChild(t)}),t}printOrder(){console.log("Payload for server:");const e={user:this.state.user,itemIds:this.state.shoppingCart.map(e=>e.id)};console.log(e)}renderViewModal(e){try{const t=this.viewRenderFns[e]();this.renderModal(t)}catch(t){console.error(`Error when trying to render view ${e}`),console.error(error)}}renderModal(e){this.modal.render(e),this.modal.show()}}(new o).init()}]);